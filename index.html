<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rebel Ribbon Cookies</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css">
    <style>
        body {
            font-family: 'Georgia', serif;
            text-align: center;
            background: #fef6f0 url('background-pattern.png');
            color: #5a3e36;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            box-sizing: border-box;
        }
        
        .container {
            width: 90%;
            max-width: 900px;
            margin: 20px auto;
            padding: 20px;
            background: #fff;
            border-radius: 15px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
            position: relative;
            box-sizing: border-box;
        }
        
        .hero {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            height: 350px;
            overflow: hidden;
            position: relative;
            box-sizing: border-box;
        }
        
        .hero img {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50%;
            max-width: 250px;
            opacity: 0.15;
            z-index: 1;
            pointer-events: none;
            box-sizing: border-box;
        }
        
        .hero h1, .hero p {
            position: relative;
            z-index: 2;
            box-sizing: border-box;
        }

        .hero h1 {
            font-size: 32px;
            margin-bottom: 10px;
            box-sizing: border-box;
        }

        .hero .order-button {
            background-color: #eac4d5;
            color: #5a3e36;
            padding: 6px 10px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            margin-top: 20px;
            display: inline-block;
            font-size: clamp(12px, 2vw, 16px);
            box-sizing: border-box;
            transition: color 0.3s ease;
            position: relative;
            z-index: 3;
        }

        .hero .order-button:hover {
            color: white;
            box-sizing: border-box;
        }

        nav {
            background: #eac4d5;
            padding: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            max-width: 900px;
            margin: 20px auto;
            border-radius: 10px;
            gap: 5px;
            box-sizing: border-box;
            width: 90%;
        }
        
        nav a {
            text-decoration: none;
            font-weight: bold;
            color: #5a3e36;
            font-size: clamp(12px, 2vw, 16px);
            transition: color 0.3s ease;
            padding: 6px 10px;
            white-space: nowrap;
            border-radius: 5px;
            box-sizing: border-box;
        }
        
        nav a:hover {
            color: white;
            box-sizing: border-box;
        }
        
        nav a.disabled {
            pointer-events: none;
            color: grey;
            box-sizing: border-box;
        }
        
        .content-section {
            padding: 20px;
            background: white;
            margin-top: 20px;
            border-radius: 15px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
            box-sizing: border-box;
        }
        
        /* Ensure uniform spacing and prevent overflow */
        .instagram-widget {
            width: 90%;
            max-width: 900px;
            margin: 20px auto;
            padding: 20px;
            background: #fff;
            border-radius: 15px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
            position: relative;
            box-sizing: border-box;
        }
        
        .elfsight-app {
            max-width: 100% !important;
            width: 100% !important;
            padding: 10px;
            display: flex;
            justify-content: center;
            box-sizing: border-box;
        }
        
        .instagram-widget iframe {
            max-width: 100%;
            width: 100%;
            height: auto;
            box-sizing: border-box;
        }
        
        @media (max-width: 768px) {
            .instagram-widget {
                padding: 15px 0;
                box-sizing: border-box;
            }
            .elfsight-app {
                width: 95% !important;
                box-sizing: border-box;
            }
        }
    </style>
</head>
<body>
    <div class="container hero">
        <img src="Bowtrans.png" alt="Rebel Ribbon Logo">
        <h1>Welcome to Rebel Ribbon Cookies</h1>
        <p>Delicious, homemade cookies crafted with love.</p>
        <a href="order.html" class="order-button">Order Now</a>
    </div>

    <nav>
        <a href="#" class="disabled">Home</a>
        <a href="about.html">About Us</a>
        <a href="gallery.html">Gallery</a>
        <a href="contact.html">Contact Us</a>
    </nav>

    <div class="container instagram-widget">
        <script src="https://static.elfsight.com/platform/platform.js" async></script>
        <div class="elfsight-app-6b3d4c64-62f6-48b0-bd95-35fce2520756" data-elfsight-app-lazy></div>
    </div>

    <div class="container content-section">
        <h2>Our Story</h2>
        <p>Rebel Ribbon began as a passion project, transforming simple cookies into edible works of art. Founded by Alinka Chalker in 2017 and later joined by her sister Tabata in 2025, our brand blends craftsmanship, creativity, and heartfelt design.</p>
        <p>Every cookie we create is more than just a treat—it's a personalized touch for life's special moments, from birthdays to weddings and beyond.</p>
    </div>

   <div class="container content-section">
        <h2>How to Place an Order</h2>
        <p>1. Click 'Order Now' to begin your request.</p>
        <p>2. Complete the form with your details and preferences.</p>
        <p>3. Upload an inspiration image if available.</p>
        <p>4. Submit your order, and we'll reply within 48 hours.</p>
    </div>

    <div class="container content-section">
    <h2>What Our Customers Say</h2>
    <div class="swiper">
        <div class="swiper-wrapper" id="testimonial-container">
            <!-- Reviews will be injected here -->
        </div>
        <div class="swiper-pagination"></div>
    </div>
</div>     
       <div class="container content-section">
        <h2>Frequently Asked Questions</h2>
        <details>
            <summary>How early should I place my order?</summary>
            <p>We recommend placing your order at least two weeks in advance.</p>
        </details>
        <details>
            <summary>Do you offer gluten-free or vegan options?</summary>
            <p>Yes, we have gluten-free and vegan-friendly options upon request.</p>
        </details>
        <details>
            <summary>Can I customize my order?</summary>
            <p>Absolutely! We specialize in custom designs. Let us know your vision!</p>
        </details>
        <details>
            <summary>Do you ship your cookies?</summary>
            <p>Yes, we offer nationwide shipping for an additional fee.</p>
        </details>
        <details>
            <summary>What payment methods do you accept?</summary>
            <p>We accept credit/debit cards, PayPal, and Venmo.</p>
        </details>
        <details>
            <summary>How long do the cookies stay fresh?</summary>
            <p>Our cookies stay fresh for up to two weeks when stored in an airtight container.</p>
        </details>
        <details>
            <summary>Can I request a bulk order?</summary>
            <p>Yes! We accommodate bulk orders for events and corporate gifting.</p>
        </details>
        <details>
            <summary>Do you offer gift packaging?</summary>
            <p>Yes, we provide elegant gift packaging upon request.</p>
        </details>
        <details>
            <summary>Do you offer cookie decorating classes?</summary>
            <p>We occasionally host decorating workshops. Contact us for upcoming dates.</p>
        </details>
        <details>
            <summary>How should I store my cookies?</summary>
            <p>Keep them in a cool, dry place in an airtight container to maintain freshness.</p>
        </details>
    </div>
    <footer class="container" style="background: #eac4d5; padding: 10px; margin-top: 20px; border-radius: 5px; text-align: center; font-size: 14px;">
        <p>&copy; 2025 Rebel Ribbon Cookies. All Rights Reserved.</p>
        <p><a href="privacy.html" style="color: #5a3e36; text-decoration: none; font-weight: bold;">Privacy Policy</a> | <a href="terms.html" style="color: #5a3e36; text-decoration: none; font-weight: bold;">Terms of Service</a></p>
        <p>Follow us on: 
            <a href="https://www.instagram.com/rebel_ribbon/" style="color: #5a3e36; text-decoration: none; font-weight: bold;">Instagram</a> 
        </p>
         
         <iframe src="https://tally.so/embed/wokM7x?alignLeft=1&hideTitle=1&transparentBackground=1&dynamicHeight=1" width="300" height="157" frameborder="0" marginheight="0" marginwidth="0" title="Newsletter Signup"></iframe>
    </footer>
<script src="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js"></script>
<script>
async function loadReviews() {
    try {
        const response = await fetch("https://docs.google.com/spreadsheets/d/1ONgf1I9011IpKLz2CtS_Mk-rBEZVhLRAvJHYMLoCOdo/gviz/tq?tqx=out:csv");
        const data = await response.text();

        console.log("Raw CSV Data:", data); // Debugging log

        // Function to properly parse CSV, handling commas inside quotes
        function parseCSV(str) {
            const result = [];
            let insideQuote = false;
            let value = "";

            for (let i = 0; i < str.length; i++) {
                const char = str[i];

                if (char === '"' && str[i + 1] === '"') {
                    value += '"'; // Handle escaped double quotes
                    i++;
                } else if (char === '"') {
                    insideQuote = !insideQuote; // Toggle inside quote state
                } else if (char === "," && !insideQuote) {
                    result.push(value.trim());
                    value = "";
                } else {
                    value += char;
                }
            }

            result.push(value.trim()); // Add last value
            return result;
        }

        let rows = data.split("\n").slice(1).map(row => parseCSV(row));

        // ✅ Randomize the order of reviews
        rows = rows.sort(() => Math.random() - 0.5);

        let container = document.getElementById("testimonial-container");
        container.innerHTML = ""; // Clear existing content

        rows.forEach(columns => {
            let reviewText = columns[11]; // Column L (Review)
            let firstName = columns[3]; // Column D (First Name)
            let lastInitial = columns[4]?.charAt(0); // Column E (Last Name Initial)

            if (reviewText && firstName && lastInitial) {
                let slide = document.createElement("div");
                slide.classList.add("swiper-slide");
                slide.innerHTML = `<p>"${reviewText}" - ${firstName} ${lastInitial}.</p>`;
                container.appendChild(slide);
            }
        });

        console.log("Reviews Loaded Successfully (Randomized)");

        new Swiper(".swiper", {
            loop: true,
            autoplay: { delay: 3000 },
            });

    } catch (error) {
        console.error("Error fetching reviews:", error);
    }
}

loadReviews();


</script>

</body>
</html>
